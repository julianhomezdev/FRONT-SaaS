<div class="modal-overlay">
    <div class="modal-card">
        <div class="modal-header">
            <h2>Crear Nuevo Producto</h2>
            <button class="close-btn" (click)="onCancel()">×</button>
        </div>

        <form (ngSubmit)="onSubmit()" class="product-form">
            <div class="form-group">
                <label for="productName">Nombre del Producto:</label>
                <input 
                    type="text" 
                    id="productName"
                    [(ngModel)]="productData.productName" 
                    name="productName"
                    required
                    placeholder="Ingresa el nombre del producto">
            </div>

            <div class="form-group">
                <label for="productReference">Referencia:</label>
                <input 
                    type="text" 
                    id="productReference"
                    [(ngModel)]="productData.productReference" 
                    name="productReference"
                    required
                    placeholder="Ingresa la referencia">
            </div>

            <div class="form-group">
                <label for="productPrice">Precio:</label>
                <input 
                    type="number" 
                    id="productPrice"
                    [(ngModel)]="productData.productPrice" 
                    name="productPrice"
                    required
                    min="0"
                    step="0.01"
                    placeholder="0.00">
            </div>

            <div class="form-group">
                <label for="productTypeId">Tipo de Producto:</label>
                <select 
                    id="productTypeId"
                    [(ngModel)]="productData.productTypeId" 
                    name="productTypeId">
                    <option value="1">Tipo 1</option>
                    <option value="2">Tipo 2</option>
                    <option value="3">Tipo 3</option>
                </select>
            </div>

            <div class="sizes-section">
                <div class="section-header">
                    <h3>Tallas y Stock</h3>
                    <button type="button" class="btn-add-size" (click)="addSize()">+ Agregar Talla</button>
                </div>

                <!-- Estado de carga -->
                <div *ngIf="loadingSizes" class="loading-sizes">
                    Cargando tallas disponibles...
                </div>

                <div *ngFor="let size of productData.sizes; let i = index" class="size-row">
                    <div class="size-select">
                        <label>Talla:</label>
                        <select [(ngModel)]="size.sizeId" [name]="'sizeId_' + i">
                            <option *ngFor="let availableSize of availableSizes" 
                                    [value]="availableSize.id">
                                {{ availableSize.sizeName }} <!-- ← CORREGIR: "name" a "sizeName" -->
                            </option>
                        </select>
                    </div>
                    
                    <div class="stock-input">
                        <label>Stock:</label>
                        <input 
                            type="number" 
                            [(ngModel)]="size.stock" 
                            [name]="'stock_' + i"
                            min="0"
                            placeholder="0">
                    </div>
                    
                    <button type="button" class="btn-remove-size" (click)="removeSize(i)">×</button>
                </div>

                <!-- Mensaje cuando no hay tallas -->
                <div *ngIf="productData.sizes.length === 0 && !loadingSizes" class="no-sizes">
                    No hay tallas agregadas. Haz clic en "Agregar Talla" para comenzar.
                </div>
            </div>

            <div class="form-actions">
                <button type="button" class="btn-cancel" (click)="onCancel()">Cancelar</button>
                <button type="submit" class="btn-submit" [disabled]="loading">
                    {{ loading ? 'Creando...' : 'Crear Producto' }}
                </button>
            </div>

            <div *ngIf="error" class="error-message">
                {{ error }}
            </div>
        </form>
    </div>
</div>